tried my best...main logic below:

![main-logic](img/main.png)